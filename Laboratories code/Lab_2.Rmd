---
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
library(plotly)
library(GGally)
library(ggplot2)
df <- read_csv("../Spotify_final_dataset.csv")
```

# Ð—Ð°Ð²Ð´Ð°Ð½Ð½Ñ 1: ÐŸÐ¾Ð±ÑƒÐ´Ð¾Ð²Ð° Ð¾Ð´Ð½Ð¾Ñ„Ð°ÐºÑ‚Ð¾Ñ€Ð½Ð¾Ñ— Ð¼Ð¾Ð´ÐµÐ»Ñ–

Ð’Ð¸ÐºÐ¾Ð½Ð°Ð¹Ñ‚Ðµ Ñ‡Ð¸ÑÑ‚ÐºÑƒ dataset Ð¾Ð´Ð½Ð¸Ð¼ Ð·Ñ– ÑÐ¿Ð¾ÑÐ¾Ð±Ñ–Ð²:
â€¢ Ð²Ð¸Ð´Ð°Ð»ÐµÐ½Ð½Ñ Ð¿Ð¾Ñ€Ð¾Ð¶Ð½Ñ–Ñ…, Ð·Ð°Ð¼Ñ–Ð½Ð¾ÑŽ Ð½Ð° ÑÐµÑ€ÐµÐ´Ð½Ñ” Ñ‡Ð¸ Ð¼ÐµÐ´Ñ–Ð°Ð½Ð½Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ,
Ð¿Ñ€Ð¾Ð³Ð½Ð¾Ð·ÑƒÐ²Ð°Ð½Ð½Ñ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð¸Ñ… Ð´Ð°Ð½Ð¸Ñ…,
â€¢ Ð·Ð°Ð¼Ñ–Ð½Ð° Ð½ÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¸Ñ… Ñ‚Ð¸Ð¿Ñ–Ð² Ñƒ dataset.

```{r}
colnames(df)[2]='Artist_name'
colnames(df)[3]='Song_name'
colnames(df)[5]='Top_ten_times'
colnames(df)[6]='Peak_position'
colnames(df)[7]='Peak_position_times'
colnames(df)[8]='Peak_streams'
colnames(df)[9]='Total_streams'


df$Peak_position_times <- gsub("[(x)]","" , df$Peak_position_times ,ignore.case = TRUE)
df$Peak_position_times <- as.numeric(df$Peak_position_times)
```


Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑŽÑ‡Ð¸ ÐºÐ¾Ð¼Ð¿'ÑŽÑ‚ÐµÑ€Ð½Ðµ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð½Ðµ Ð·Ð°Ð±ÐµÐ·Ð¿ÐµÑ‡ÐµÐ½Ð½Ñ Ð²Ð¸ÐºÐ¾Ð½Ð°Ð¹Ñ‚Ðµ Ð¾Ñ†Ñ–Ð½ÐºÑƒ Ð¼Ð¾Ð´ÐµÐ»Ñ–
Ð·Ð°Ð»ÐµÐ¶Ð½Ð¾ÑÑ‚Ñ– ð‘Œ = ð›½0 + ð›½1ð‘‹1 + ðœ€.

Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑ”Ð¼Ð¾ 
X - Peak Position times
Y - Top Ten Times

```{r}
x1 <- df$Peak_position_times
Y <- df$Top_ten_times
x1_scaled <- scale(x1)
mod1 <- lm(Y ~ x1_scaled)
```

(A) Ð—Ð½Ð°Ð¹Ð´Ñ–Ñ‚ÑŒ Ð¾Ñ†Ñ–Ð½ÐµÐ½Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ
```{r}
b1 <- cov(x1_scaled, Y)/var(x1_scaled)
b1 <- b1[1,1]
b1
```

(B) Ð—Ð½Ð°Ð¹Ð´Ñ–Ñ‚ÑŒ Ð¾Ñ†Ñ–Ð½ÐµÐ½Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ 
```{r}
b0 <- mean(Y) - b1*mean(x1_scaled)
b0
```

(C) Ð—Ð° Ð´Ð¾Ð¿Ð¾Ð¼Ð¾Ð³Ð¾ÑŽ Ð²Ð±ÑƒÐ´Ð¾Ð²Ð°Ð½Ð¾Ñ— Ñ„ÑƒÐ½ÐºÑ†Ñ–Ñ— lm () Ð·Ð°Ð¿Ð¸ÑˆÑ–Ñ‚ÑŒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ Ð¾Ñ†Ñ–Ð½ÐµÐ½Ð¸Ñ… ÐºÐ¾ÐµÑ„Ñ–Ñ†Ñ–Ñ”Ð½Ñ‚Ñ–Ð²
(mod1 <- lm(Y ~ X, data)).
```{r}
mod1 <- lm(Y ~ x1_scaled)
coefs <- mod1$coefficients
coefs
```

(D) Ð—Ñ€Ð¾Ð±Ñ–Ñ‚ÑŒ Ð²Ð¸ÑÐ½Ð¾Ð²ÐºÐ¸ Ð¿Ñ€Ð¾ Ð·Ð±Ñ–Ð³ ÐºÐ¾ÐµÑ„Ñ–Ñ†Ñ–Ñ”Ð½Ñ‚Ñ–Ð². Ð—Ð°Ð¿Ð¸ÑˆÑ–Ñ‚ÑŒ Ð°Ð½Ð°Ð»Ñ–Ñ‚Ð¸Ñ‡Ð½Ð¸Ð¹ Ð²Ð¸Ð³Ð»ÑÐ´ Ð¼Ð¾Ð´ÐµÐ»Ñ– Ð·
Ð²Ñ–Ð´Ð¾Ð¼Ð¸Ð¼Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½ÑÐ¼Ð¸ ÐºÐ¾ÐµÑ„Ñ–Ñ†Ñ–Ñ”Ð½Ñ‚Ñ–Ð²;
```{r}
smod1 <- summary(mod1)
smod1
```

ÐšÐ¾ÐµÑ„Ñ–Ñ†Ñ–ÐµÐ½Ñ‚ Ð´ÐµÑ‚ÐµÑ€Ð¼Ñ–Ð½Ð°Ñ†Ñ–Ñ— Ñ€Ñ–Ð²ÐµÐ½ 0.495, Ñ‰Ð¾ Ñ€Ð¾Ð±Ð¸Ñ‚ÑŒ Ñ†ÑŽ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð½ÐµÐ¿Ñ€Ð¸Ð¹Ð½Ñ‚ÑÐ½Ð¾ÑŽ

```{r}
anltc_mdl <- b0 + b1*x1_scaled
anltc_mdl
```

#Ð—Ð°Ð²Ð´Ð°Ð½Ð½Ñ 2: ÐŸÐ¾Ð±ÑƒÐ´Ð¾Ð²Ð° 2-Ñ… Ñ„Ð°ÐºÑ‚Ð¾Ñ€Ð½Ð¾Ñ— Ð¼Ð¾Ð´ÐµÐ»Ñ–

Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑŽÑ‡Ð¸ ÐºÐ¾Ð¼Ð¿'ÑŽÑ‚ÐµÑ€Ð½Ðµ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð½Ðµ Ð·Ð°Ð±ÐµÐ·Ð¿ÐµÑ‡ÐµÐ½Ð½Ñ Ð²Ð¸ÐºÐ¾Ð½Ð°Ð¹Ñ‚Ðµ Ñ€ÐµÐ³Ñ€ÐµÑÑ–Ð¹Ð½Ñ–
Ñ€Ð¾Ð·Ñ€Ð°Ñ…ÑƒÐ½ÐºÐ¸ Ñ‚Ð° Ð¿Ð¾Ð±ÑƒÐ´ÑƒÐ¹Ñ‚Ðµ Ð¼Ð¾Ð´ÐµÐ»ÑŒ, ÐºÐ¾Ð»Ð¸ ð‘ = 2, Ñ‚Ð¾Ð±Ñ‚Ð¾ Ð·Ð° 2-Ð¼Ð° Ð½ÐµÐ·Ð°Ð»ÐµÐ¶Ð½Ð¸Ð¼Ð¸ Ð·Ð¼Ñ–Ð½Ð½Ð¸Ð¼Ð¸.

Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑ”Ð¼Ð¾ 
X1 - Peak Position times
X2 - Peak Streams
Y - Top Ten Times

(A) Ð—Ð½Ð°Ð¹Ð´Ñ–Ñ‚ÑŒ Ð¾Ñ†Ñ–Ð½ÐµÐ½Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ Ð²ÐµÐºÑ‚Ð¾Ñ€Ð° ÐºÐ¾ÐµÑ„Ñ–Ñ†Ñ–Ñ”Ð½Ñ‚Ñ–Ð² ðœ· Ð·Ð° Ð´Ð¾Ð¿Ð¾Ð¼Ð¾Ð³Ð¾ÑŽ Ð°Ð½Ð°Ð»Ñ–Ñ‚Ð¸Ñ‡Ð½Ð¾Ñ—
Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ð¸ (2.1) Ð´Ð»Ñ 2-Ñ… Ñ„Ð°ÐºÑ‚Ð¾Ñ€Ð½Ð¾Ñ— Ð¼Ð¾Ð´ÐµÐ»Ñ–;
```{r}
x2 = df$Peak_streams
x2_scaled <- scale(x2)

mod2 <- lm(Y ~ x1_scaled + x2_scaled)
mod2$coefficients
X <- cbind(1,x1_scaled, x2_scaled)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y  
beta
```

(B) Ð—Ð° Ð´Ð¾Ð¿Ð¾Ð¼Ð¾Ð³Ð¾ÑŽ Ð²Ð±ÑƒÐ´Ð¾Ð²Ð°Ð½Ð¾Ñ— Ñ„ÑƒÐ½ÐºÑ†Ñ–Ñ— lm () Ð¾Ð±Ñ‡Ð¸ÑÐ»Ñ–Ñ‚ÑŒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ Ð¾Ñ†Ñ–Ð½ÐµÐ½Ð¸Ñ… ÐºÐ¾ÐµÑ„Ñ–Ñ†Ñ–Ñ”Ð½Ñ‚Ñ–Ð²
(mod2 <- lm(Y ~ x1 + x2, data)).
```{r}
mod2
```

(C) Ð—Ñ€Ð¾Ð±Ñ–Ñ‚ÑŒ Ð²Ð¸ÑÐ½Ð¾Ð²ÐºÐ¸ Ð¿Ñ€Ð¾ Ð·Ð±Ñ–Ð³ ÐºÐ¾ÐµÑ„Ñ–Ñ†Ñ–Ñ”Ð½Ñ‚Ñ–Ð². Ð—Ð°Ð¿Ð¸ÑˆÑ–Ñ‚ÑŒ Ð°Ð½Ð°Ð»Ñ–Ñ‚Ð¸Ñ‡Ð½Ð¸Ð¹ Ð²Ð¸Ð³Ð»ÑÐ´ Ð¼Ð¾Ð´ÐµÐ»Ñ– Ð·
Ð²Ñ–Ð´Ð¾Ð¼Ð¸Ð¼Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½ÑÐ¼Ð¸ ÐºÐ¾ÐµÑ„Ñ–Ñ†Ñ–Ñ”Ð½Ñ‚Ñ–Ð²;
```{r}
smod2 <- summary(mod2)
smod2
```

ÐšÐ¾ÐµÑ„Ñ–Ñ†Ñ–ÐµÐ½Ñ‚ Ð´ÐµÑ‚ÐµÑ€Ð¼Ñ–Ð½Ð°Ñ†Ñ–Ñ— Ð·Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒÑÑ Ð½Ð° Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ 0.5219, Ñ†Ñ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ñ” Ð¿Ñ€Ð¸Ð¹Ð½ÑÑ‚Ð½Ð¾ÑŽ

```{r}
anltc_mdl2 <- X[, 2:3]*beta[1:2,1]+ beta[1,1]
anltc_mdl2 <- t(anltc_mdl2[,1] + anltc_mdl2[, 2])
plot(anltc_mdl2, Y)
abline(a = 0, b = 1, col=2)
```


(D) Ð’Ð¸Ð´Ñ€ÑƒÐºÑƒÐ¹Ñ‚Ðµ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ð½Ñ– Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ Ð´Ð»Ñ ð‘Œ mod2$fitted.values Ñ‚Ð° Ð¿Ð¾Ñ…Ð¸Ð±Ð¾Ðº ðœ€
mod2$residuals;
```{r}
smod2 <- summary(mod2)
smod2$residuals
smod2$fitted.values
```


# Ð—Ð°Ð²Ð´Ð°Ð½Ð½Ñ 3: ÐŸÐ¾Ð±ÑƒÐ´Ð¾Ð²Ð° Ð¼Ð°Ñ‚ÐµÐ¼Ð°Ñ‚Ð¸Ñ‡Ð½Ð¾Ñ— Ð¼Ð¾Ð´ÐµÐ»Ñ– Ð·Ð° Ð²ÑÑ–Ð¼Ð° Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ð¼Ð¸

(A) Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑŽÑ‡Ð¸ ÐºÐ¾Ð¼Ð¿â€™ÑŽÑ‚ÐµÑ€Ð½Ðµ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð½Ðµ Ð·Ð°Ð±ÐµÐ·Ð¿ÐµÑ‡ÐµÐ½Ð½Ñ Ð²Ð¸ÐºÐ¾Ð½Ð°Ð¹Ñ‚Ðµ Ñ€ÐµÐ³Ñ€ÐµÑÑ–Ð¹Ð½Ñ–
Ñ€Ð¾Ð·Ñ€Ð°Ñ…ÑƒÐ½ÐºÐ¸ Ñ‚Ð° Ð¿Ð¾Ð±ÑƒÐ´ÑƒÐ¹Ñ‚Ðµ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð·Ð° Ð½Ðµ Ð±Ñ–Ð»ÑŒÑˆÐµ Ð½Ñ–Ð¶ 5-Ð¼Ð° Ð½ÐµÐ·Ð°Ð»ÐµÐ¶Ð½Ð¸Ð¼Ð¸ Ð·Ð¼Ñ–Ð½Ð½Ð¸Ð¼Ð¸.
mod3 <- lm(Y ~ ., data)

Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑ”Ð¼Ð¾ 
X1 - Peak Position times
X2 - Peak Streams
X3 - Days
X4 - Total Steams
X5 - Peak Position
Y - Top Ten Times

```{r}
x3 <- df$Days
x4 <- df$Total_streams
x5 <- df$Peak_position

x3_scaled <- scale(x3)
x4_scaled <- scale(x4)
x5_scaled <- scale(x5)

Y <- df$Top_ten_times
mod3 <- lm(Y ~ x1_scaled + x2_scaled + x3_scaled + x4_scaled + x5_scaled)
```

(B) Ð—Ð°Ð¿Ð¸ÑˆÑ–Ñ‚ÑŒ Ð°Ð½Ð°Ð»Ñ–Ñ‚Ð¸Ñ‡Ð½Ð¸Ð¹ Ð²Ð¸Ð³Ð»ÑÐ´ Ð¼Ð¾Ð´ÐµÐ»Ñ– Ð· Ð²Ñ–Ð´Ð¾Ð¼Ð¸Ð¼Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½ÑÐ¼Ð¸ ÐºÐ¾ÐµÑ„Ñ–Ñ†Ñ–Ñ”Ð½Ñ‚Ñ–Ð²;

```{r}
smod3 <- summary(mod3)
smod3
```


```{r}
X <- cbind(1,x1_scaled, x2_scaled, x3_scaled, x4_scaled, x5_scaled)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y  

anltc_mdl3 <- X[, 2:6]*beta[1:5,1]+ beta[1,1]
anltc_mdl3 <- t(anltc_mdl3[,1] + anltc_mdl3[, 2] + anltc_mdl3[, 3] + anltc_mdl3[, 4]
                + anltc_mdl3[, 5])
plot(anltc_mdl3, Y)
abline(a = 0, b = 1, col=2)

```

(C) Ð’Ð¸Ð·Ð½Ð°Ñ‡Ñ‚Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ ÐºÐ¾ÐµÑ„Ñ–Ñ†Ñ–Ñ”Ð½Ñ‚Ð° Ð´ÐµÑ‚ÐµÑ€Ð¼Ñ–Ð½Ð°Ñ†Ñ–Ñ— R^2 Ð·Ð° Ð´Ð¾Ð¿Ð¾Ð¼Ð¾Ð³Ð¾ÑŽ Ð²Ð±ÑƒÐ´Ð¾Ð²Ð°Ð½Ð¾Ñ— Ñ„ÑƒÐ½ÐºÑ†Ñ–Ñ—
mod*$r.squared Ð´Ð»Ñ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ mod1, mod2 Ñ‚Ð° mod3;

```{r}
smod1$r.squared
smod2$r.squared
smod3$r.squared
```

Ð¢Ñ€ÐµÑ‚Ñ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð· Ð½Ð°Ð¹Ð±Ñ–Ð»ÑŒÑˆÐ¸Ð¼ ÐºÐ¾ÐµÑ„Ñ–Ñ†Ñ–ÐµÐ½Ñ‚Ð¾Ð¼ Ð´ÐµÑ‚ÐµÑ€Ð¼Ñ–Ð½Ð°Ñ†Ñ–Ñ— 

(D) Ð’Ð¸Ð´Ñ€ÑƒÐºÑƒÐ¹Ñ‚Ðµ car::scatterplotMatrix (ggpairs(df, columns = c(1,4:9))) 
Ñ‚Ð° Ð²ÐºÐ°Ð¶Ñ–Ñ‚ÑŒ, ÑÐºÑ– Ð·Ð¼Ñ–Ð½Ð½Ñ– Ð½Ð° Ð²Ð°Ñˆ Ð¿Ð¾Ð³Ð»ÑÐ´ Ð¼Ð°ÑŽÑ‚ÑŒ Ð±Ñ–Ð»ÑŒÑˆ
Ð»Ñ–Ð½Ñ–Ð¹Ð½Ð¸Ð¹ Ð·Ð²â€™ÑÐ·Ð¾Ðº:

```{r}
p <- ggpairs(df, columns = c(1,4:9)) 

p + theme(strip.text.x = element_text(size = 8),
          strip.text.y = element_text(size = 5))
```

Ð”Ð¸Ð²Ð»ÑÑ‡Ð¸ÑÑŒ Ð½Ð° Ð´Ð°Ð½Ñ– Ð³Ñ€Ð°Ñ„Ñ–ÐºÐ¸ Ð¼Ð¾Ð¶Ð½Ð° Ð²Ñ–Ð´Ð¼Ñ–Ñ‚Ð¸Ñ‚Ð¸ Ñ‚Ð°ÐºÑ– Ð·Ð¼Ñ–Ð½Ð½Ñ– ÑÐº:
Position Ñ‚Ð° Peak Position
Top Ten times Ñ‚Ð° Total Streams

Ð„ Ñ‰Ðµ Ñ–Ð½ÑˆÑ– Ñ‡ÑƒÐ´Ð¾Ð²Ñ– Ð³Ñ€Ð°Ñ„Ñ–ÐºÐ¸, Ð°Ð»Ðµ Ð²Ð¾Ð½Ð¸ Ð¼Ð°ÑŽÑ‚ÑŒ Ð½ÐµÐ»Ñ–Ð½Ñ–Ð¹Ð½Ð¸Ð¹ Ð·Ð²'ÑÐ·Ð¾Ðº