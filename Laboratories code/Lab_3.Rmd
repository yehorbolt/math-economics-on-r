---
title: "Lab_3"
output:
  word_document: default
  pdf_document: default
date: "2023-02-27"
---

# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ2 (—á–∞—Å—Ç–∏–Ω–∞ 2)

# –ü–æ–±—É–¥–æ–≤–∞ —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –ª—ñ–Ω—ñ–π–Ω–æ—ó –º–Ω–æ–∂–∏–Ω–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó.

–û–ø–∏—Å dataset

–ù–∞–∑–≤–∞ dataset:
Spotify Top 10000 Streamed Songs

Link –Ω–∞ dataset: 
https://www.kaggle.com/datasets/rakkesharv/spotify-top-10000-streamed-songs

–û–ø–∏—Å dataset —Ç–∞ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–¥–∞—á—ñ:
–¶–µ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, –∑—ñ–±—Ä–∞–Ω–∏–π –∑ –≤–µ–±-—Å–∞–π—Ç—É Spotify, –∫–æ—Ç—Ä–∏–π –º—ñ—Å—Ç–∏—Ç—å –ø–æ—Ç–æ–∫–∏ –≤–∏–∫–æ–Ω–∞–≤—Ü—è
—Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ—Å–ª—ñ—Ö–æ–≤—É–≤–∞–Ω—å (–±—É–ª–æ –≤–∑—è—Ç–æ —Å–∞–º–µ —Ç–æ–ø-10000)
–û—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞: –≤–ø–ª–∏–≤ —Ñ–∞–∫—Ç–æ—Ä—ñ–≤ –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å –ø—ñ—Å–Ω—ñ –π –¥—ñ–∑–Ω–∞—Ç–∏—Å—å –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏—Ö
–≤–∏–∫–æ–Ω–∞–≤—Ü—ñ–≤ —Ç–∞ —Ç—Ä–µ–∫–∏.

–ó–º—ñ–Ω–Ω—ñ —Ç–∞ —ó—Ö –æ–ø–∏—Å:
Position - Spotify Ranking
Artist Name - Artist Name
Song Name - Song Name
Days - No of days since the release of the song (Updated)
Top 10 (xTimes) - No of times inside top 10
Peak Position - Peak position attained
Peak Position (xTimes) - No of times Peak position attained
Peak Streams - Total no of streams during Peak position
Total Streams - Total song streams 

# –ó–∞–≤–¥–∞–Ω–Ω—è 4: –°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –æ—Ü—ñ–Ω–∫–∏ –º–æ–¥–µ–ª—ñ –∑–∞ –≤—Å—ñ–º–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

(A) –í–∫–∞–∑–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è

```{r}
library(readr)
library(plotly)
library(GGally)
library(ggplot2)
df <- read_csv("../Spotify_final_dataset.csv")

Y <- df$Top_ten_times
x1 <- df$Peak_position_times
x2 <- df$Peak_streams
x3 <- df$Days
x4 <- df$Total_streams
x5 <- df$Peak_position

x1_scaled <- scale(x1)
x2_scaled <- scale(x2)
x3_scaled <- scale(x3)
x4_scaled <- scale(x4)
x5_scaled <- scale(x5)

mod2 <- lm(Y ~ x1_scaled + x2_scaled)
mod3 <- lm(Y ~ x1_scaled + x2_scaled + x3_scaled + x4_scaled + x5_scaled)
smod3 <- summary(mod3)
smod3
```


a. Estimate: –æ—Ü—ñ–Ω–∫–∞ –Ω–∞–π–º–µ–Ω—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ ùõΩÃÇùëó
             Estimate 
(Intercept)  2.7136413 
x1_scaled    5.5889867 
x2_scaled   -0.9292734 
x3_scaled   -8.7069453 
x4_scaled   17.0567078 
x5_scaled   -0.3137653 


b. Std. Error: –û—Ü—ñ–Ω–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫ SEÃÇ(ùõΩÃÇùëó)

             Std. Error
(Intercept)  0.07803427  
x1_scaled    0.09851295  
x2_scaled    0.11099889  
x3_scaled    0.24745974 
x4_scaled    0.27418873  
x5_scaled    0.10197718  


c. t value: t -—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ùõΩÃÇùëóSEÃÇ(ùõΩÃÇùëó)

             t value     
(Intercept)  34.774995 
x1_scaled    56.733520  
x2_scaled   -8.371916  
x3_scaled   -35.185301 
x4_scaled    62.207910 
x5_scaled   -3.076818  


d. Pr(>|t|): p ‚Äì –∑–Ω–∞—á–µ–Ω–Ω—è t-—Ç–µ—Å—Ç—É

             Pr(>|t|)
(Intercept)  1.428494e-251
x1_scaled    0.000000e+00
x2_scaled    6.350423e-17
x3_scaled    3.444178e-257
x4_scaled    0.000000e+00
x5_scaled    2.097332e-03



(B) –ó–Ω–∞—á–µ–Ω–Ω—è —Å–µ—Ä–µ–¥–Ω—å–æ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∏–º –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è–º (Residual standard error)

a. –í–∏–∑–Ω–∞—á–∏—Ç–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–≥–æ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é
–Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π sqrt(sum(mod3$residuals^2)/ mod3$df.residual)

```{r}
RSE <- sqrt(sum(mod3$residuals^2)/ mod3$df.residual)
RSE
```


b. –ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Ä–∏–º–∞–Ω–∏–π –≤ (a) –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º Residual standard error –≤
–æ–±‚Äô—î–∫—Ç—ñ summary(mod3) –∞–±–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó mod3$sigma.

```{r}
RSE
smod3$sigma
```
–ó–Ω–∞—á–µ–Ω–Ω—è —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ

(C) –ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –º–æ–¥–µ–ª—ñ mod2 —Ç–∞ mod3 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é car::compareCoefs(mod2, mod3)

```{r}
car::compareCoefs(mod2, mod3)
```



# –ó–∞–≤–¥–∞–Ω–Ω—è 5: –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ –º–æ–¥–µ–ª—ñ —Ç–∞ —Ü–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è dataset

(A) –í–∫–∞–∑–∞—Ç–∏ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ –¥–ª—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ ùõΩÃÇùëó –∑ —Ä—ñ–∑–Ω–∏–º–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏ –¥–æ–≤—ñ—Ä–∏

a. 0.95% —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–æ–≤—ñ—Ä–∏ –¥–ª—è ùõΩÃÇùëó
```{r}
confint(mod3, level = .95)
```

b. 0.90% —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–æ–≤—ñ—Ä–∏ –¥–ª—è ùõΩÃÇùëó
```{r}
confint(mod3, level = .90)
```

c. 0.99% —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–æ–≤—ñ—Ä–∏ –¥–ª—è ùõΩÃÇùëó
```{r}
confint(mod3, level = .99)
```


(B) –í–∏–∫–æ–Ω–∞–π—Ç–µ —Ü–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è dataset

a. —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ü–µ–Ω—Ç—Ä–æ–≤–∞–Ω–∏–π dataCen;
```{r}
dataCen <- data.frame(scale(df[c(1,4:9)] , center = TRUE,scale = FALSE))
dataCen

x1_cen <- dataCen$Peak_position_times
x2_cen <- dataCen$Peak_streams
x3_cen <- dataCen$Days
x4_cen <- dataCen$Total_streams
x5_cen <- dataCen$Peak_position
```


b. –ø–æ–±—É–¥—É–π—Ç–µ –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–µ –º–æ–¥–µ–ª—ñ mod3 –º–æ–¥–µ–ª—å modCen –¥–ª—è dataCen
```{r}
mod3 <- lm(Y ~ x1_scaled + x2_scaled + x3_scaled + x4_scaled + x5_scaled)
summary(mod3)


mod_cen <- lm(Y ~ x1_cen + x2_cen + x3_cen + x4_cen + x5_cen)
summary(mod_cen)
```


c. –ø–æ—Ä—ñ–≤–Ω—è–π—Ç–µ —á–∏ –∑–±—ñ–≥–∞—é—Ç—å—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –æ—Ü—ñ–Ω–∫–∏ –≤ –æ–±–æ—Ö –º–æ–¥–µ–ª—è—Ö.
–°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –æ—Ü—ñ–Ω–∫–∏ –∑–±—ñ–≥–∞—é—Ç—å—Å—è


# –ó–∞–≤–¥–∞–Ω–Ω—è 6: –ü—Ä–æ–≥–Ω–æ–∑

(A) –ó–∞–¥–∞–π—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è ùëã1 = ùë•1,‚Ä¶ ,ùëãùëù = ùë•ùëù –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è, –∑ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ ùëñ-–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞ —è–∫ ùëöùëéùë•(ùëãùëñ) + 10%;
```{r}
topPrediction <- data.frame(x1 = max(x1) + 0.1 * max(x1), 
                              x2 = max(x2) + 0.1 * max(x2),
                              x3 = max(x3) + 0.1 * max(x3),
                              x4 = max(x4) + 0.1 * max(x4),
                              x5 = max(x5) + 0.1 * max(x5))
topPrediction

top_predict <- lm(Y ~ x1 + x2 + x3 + x4 + x5)

predict(top_predict, newdata = topPrediction)
```


(B) –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —Å–µ—Ä–µ–¥–∏–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è ùëåÃÇ —Ç–∞ –π–æ–≥–æ –¥–æ–≤—ñ—Ä—á–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É:

a. 95% –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª;
```{r}
predict(top_predict, newdata = topPrediction, interval = "confidence", level = 0.95)
```


b. 90% –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª;
```{r}
predict(top_predict, newdata = topPrediction, interval = "confidence", level = 0.90)
```


c. 99% –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª;
```{r}
predict(top_predict, newdata = topPrediction, interval = "confidence", level = 0.99)
```


(C) –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è ùëåÃÇ —Ç–∞ –π–æ–≥–æ –¥–æ–≤—ñ—Ä—á–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É –ø—Ä–∏ —É–º–æ–≤—ñ, —â–æ —Ü–µ –Ω–µ–≤—ñ–¥–æ–º–µ
–∑–Ω–∞—á–µ–Ω–Ω—è –ª–µ–∂–∏—Ç—å –∑–∞ –º–µ–∂–∞–º–∏ –¥–æ—Å–ª—ñ–¥–∂—É–≤–∞–Ω–æ–≥–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É:

a. 95% –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª;
```{r}
predict(top_predict, newdata = topPrediction, interval = "prediction", level = 0.95)
```


b. 90% –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª;
```{r}
predict(top_predict, newdata = topPrediction, interval = "prediction", level = 0.90)
```


c. 99% –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª;
```{r}
predict(top_predict, newdata = topPrediction, interval = "prediction", level = 0.99)
```

