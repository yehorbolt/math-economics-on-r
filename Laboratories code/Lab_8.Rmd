---
title: "Lab_3.4"
output: word_document
date: "2023-04-05"
---

# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ8

# –ú–æ–¥–µ–ª—å–Ω–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞. 

–û–ø–∏—Å dataset

–ù–∞–∑–≤–∞ dataset:
Spotify Top 10000 Streamed Songs

Link –Ω–∞ dataset: 
https://www.kaggle.com/datasets/rakkesharv/spotify-top-10000-streamed-songs

–û–ø–∏—Å dataset —Ç–∞ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–¥–∞—á—ñ:
–¶–µ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, –∑—ñ–±—Ä–∞–Ω–∏–π –∑ –≤–µ–±-—Å–∞–π—Ç—É Spotify, –∫–æ—Ç—Ä–∏–π –º—ñ—Å—Ç–∏—Ç—å –ø–æ—Ç–æ–∫–∏ –≤–∏–∫–æ–Ω–∞–≤—Ü—è
—Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ—Å–ª—ñ—Ö–æ–≤—É–≤–∞–Ω—å (–±—É–ª–æ –≤–∑—è—Ç–æ —Å–∞–º–µ —Ç–æ–ø-10000)
–û—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞: –≤–ø–ª–∏–≤ —Ñ–∞–∫—Ç–æ—Ä—ñ–≤ –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å –ø—ñ—Å–Ω—ñ –π –¥—ñ–∑–Ω–∞—Ç–∏—Å—å –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏—Ö
–≤–∏–∫–æ–Ω–∞–≤—Ü—ñ–≤ —Ç–∞ —Ç—Ä–µ–∫–∏.

–ó–º—ñ–Ω–Ω—ñ —Ç–∞ —ó—Ö –æ–ø–∏—Å:
Position - Spotify Ranking
Artist Name - Artist Name
Song Name - Song Name
Days - No of days since the release of the song (Updated)
Top 10 (xTimes) - No of times inside top 10
Peak Position - Peak position attained
Peak Position (xTimes) - No of times Peak position attained
Peak Streams - Total no of streams during Peak position
Total Streams - Total song streams 


```{r}
library(car)
library(readr)
library(plotly)
library(GGally)
library(ggplot2)
df <- read_csv("../Spotify_final_dataset.csv")

y <- df$Top_ten_times
x1 <- df$Peak_position_times
x2 <- df$Peak_streams
x3 <- df$Days
x4 <- df$Total_streams
x5 <- df$Position
x6 <- df$Peak_position

mod <- lm(y ~ x1 + x2 + x3 + x4);
mod_1 <- lm(y ~ x1 + x2 + x3);

summary(mod)
summary(mod_1)
```

# –ó–∞–≤–¥–∞–Ω–Ω—è 1: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–∞–Ω—ñ –Ω–∞ –ª—ñ–Ω—ñ–π–Ω—ñ—Å—Ç—å

# mod 

(A) –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ –≥—Ä–∞—Ñ—ñ—á–Ω–æ plot(*, 1);
```{r}
plot(mod,1)
```

(B) –ü–æ–±—É–¥—É–≤–∞—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ ùëå~ùë•ùëñ, ùëñ = 1, ‚Ä¶ ,4
termplot(mod, partial.resid = TRUE)
```{r}
par(mfrow = c(2, 2))
termplot(mod, partial.resid = TRUE)
```

(C) –í–∫–∞–∑–∞—Ç–∏ —è–∫—ñ –∑–º—ñ–Ω–Ω—ñ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –∫–æ—Ä–µ–∫—Ü—ñ—ó;
–ù–∞–π–±—ñ–ª—å—à–µ –ø–æ—Ç—Ä–µ–±—É—î –∑–º—ñ–Ω–∞ –∑–º—ñ–Ω–Ω–æ—ó —Ö1


# –ó–∞–≤–¥–∞–Ω–Ω—è 2: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–∞–Ω—ñ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω—ñ—Å—Ç—å

(A) –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ –≥—Ä–∞—Ñ—ñ—á–Ω–æ plot(*, 2);
```{r}
plot(mod,2)
```

(B) —Ç–µ—Å—Ç –®–∞–ø—ñ—Ä–æ-–í—ñ–ª—å–∫–∞
```{r}
new_df <- df[sample(nrow(df), nrow(df)*0.45),]
ny <- new_df$Top_ten_times
nx1 <- new_df$Peak_position_times
nx2 <- new_df$Peak_streams
nx3 <- new_df$Days
nx4 <- new_df$Total_streams

nmod <- lm(ny ~ nx1 + nx2 + nx3 + nx4);

shapiro.test(nmod$residuals)
```
–ß–µ—Ä–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è —É —Ä–æ–∑–º—ñ—Ä—ñ –≤–∏–±—ñ—Ä–∫–∏ –ø—Ä–∏–π—à–ª–æ—Å—å –∑–º–µ–Ω—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä –¥–æ 45% –≤—ñ–¥ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É.

(C) —Ç–µ—Å—Ç –õ—ñ–ª–ª—ñ—Ñ–æ—Ä—Å–∞
```{r}
nortest::lillie.test(mod$residuals)
```

(D) –í–∏–∫–æ–Ω–∞—Ç–∏ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è Yeo-Johnson –¥–ª—è –∑–º—ñ–Ω–Ω–æ—ó, —è–∫–∞ ùë•ùëñ —è–∫–∞ –Ω–∞ –≤–∞—à –ø–æ–≥–ª—è–¥ –Ω–µ —î
–Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∞
```{r}
YJ <- car::powerTransform(lm(x1 ~ 1), family = "yjPower")
(lambdaYJ <- YJ$lambda)

x1Transf <- car::yjPower(U = x1, lambda = lambdaYJ)
```

(E) –ü–æ–±—É–¥—É–π—Ç–µ –≥—ñ—Å—Ç–æ–≥—Ä–∞–º–∏ –¥–ª—è ùë•ùëñ –¥–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó —ñ –ø—ñ—Å–ª—è;
```{r}
par(mfrow = c(1, 2))
hist(x1, freq = FALSE, breaks = 10)
hist(x1Transf, freq = FALSE, breaks = 10)
```

(F) –í–∏–∫–æ–Ω–∞–π—Ç–µ —Ç–≤–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—é Yeo-Johnson –¥–ª—è Y (YTransf);
```{r}
YTransf <- car::yjPower(U = y, lambda = lambdaYJ)
```

(G) –ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ plot(*, 2) –¥–ª—è Y —Ç–∞ YTransf
```{r}
par(mfrow = c(1, 2))
plot(lm(y ~ x1 + x2 + x3 + x4), 2)
plot(lm(YTransf ~ x1 + x2 + x3 + x4),2)
```
–î—ñ–π—Å–Ω–æ –≥—Ä–∞—Ñ—ñ–∫ —Å—Ç–∞–≤ —Ç—Ä–æ—Ö–∏ –∫—Ä–∞—â–∏–º.


# –ó–∞–≤–¥–∞–Ω–Ω—è 3: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–∞–Ω—ñ –Ω–∞ –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å

(A) –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ –≥—Ä–∞—Ñ—ñ—á–Ω–æ plot(*, 3);
```{r}
plot(mod, 3)
```

(B) –î–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç –ë—Ä–µ–π—à–∞ ‚Äì –ü–∞–≥–∞–Ω–∞;
```{r}
car::ncvTest(mod)
```
–ì–æ–º–æ—Å–∫–µ–¥–∞—Ç–∏—á–Ω—ñ—Å—Ç—å –≤—ñ–¥–∫—É–¥—É—î–º–æ

(C) –í–∏–∫–æ–Ω–∞—Ç–∏ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–ª—è –∑–∞–ª–µ–∂–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∑–∞ —Ç–µ—Å—Ç–æ–º –ë—Ä–µ–π—à–∞ ‚Äì
–ü–∞–≥–∞–Ω–∞:

o Y1 <- log(abs(Y));
```{r}
Y1 <- log(abs(y))
# –£ –£1 –≤–∏–π—à–ª–æ –±–∞–≥–∞—Ç–æ -inf -> –∑–∞–º—ñ–Ω—é—î–º–æ –Ω–∞ 0
Y1[Y1 == -Inf] <- 0
mod_log_1 <- lm(Y1 ~ x1 + x2 + x3 + x4)
car::ncvTest(mod_log_1)
plot(mod_log_1, 3)
```

o Y2 <- sqrt(abs(Y));
```{r}
Y2 <- sqrt(abs(y))
mod_sqrt_1 <- lm(Y2 ~ x1 + x2 + x3 + x4)
car::ncvTest(mod_sqrt_1)
plot(mod_sqrt_1, 3)
```
–ö—Ä–∞—â–µ –Ω–µ —Å—Ç–∞–ª–æ, –±–∞–≥–∞—Ç–æ —Ä–æ–∑—Å–ø–∏–ø–∞–Ω–æ –ø–æ –ø—Ä–æ–º—ñ–∂–∫—É

o –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è –ë–æ–∫—Å–∞-–ö–æ–∫—Å–∞ Y3 <- log(Y + m));
```{r}
delta <- 6
m <- -min(y) + delta
Y3 <- I(log(y + m))
mod_log2_1 <- lm(Y3 ~ x1 + x2 + x3 + x4)
car::ncvTest(mod_log2_1)
plot(mod_log2_1, 3)
```
–ù–µ —Ç–µ —â–æ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ, –∑–Ω–∞—á–µ–Ω–Ω—è —Ä–æ–∑—Å–ø–∏—Å–∞–Ω—ñ –ø–æ –ø—Ä–æ–º—ñ–∂–∫—É

o –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑–∞ –ô–æ-–î–∂–æ–Ω—Å–æ–Ω–æ–º Y4;
```{r}
YJ <- car::powerTransform(lm(y ~ x1 + x2 + x3 + x4), family = "yjPower")
(lambdaYJ <- YJ$lambda)
Y4 <- car::yjPower(U = y, lambda = lambdaYJ)
mod_YJ_1<- lm(Y4 ~ x1 + x2 +x3 + x4)
car::ncvTest(mod_YJ_1)
plot(mod_YJ_1, 3)
```
–ü—Ç–∞—à–∫–∞. –ù–æ –≤—Å–µ –∂ –Ω–µ —Å—Ö–æ–∂–µ –Ω–∞ —Ç–µ, —â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–º (–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ –ø—Ä–æ–º—ñ–∂–∫—É 
–≤—ñ–¥ [..0.0; ~0.25]) —Å—Ö–æ–¥–∏—Ç—å—Å—è –∑ –ª—ñ–Ω—ñ—î—é

–í —Ñ—ñ–Ω–∞–ª—å–Ω–æ–º—É –≤–∏—Å–Ω–æ–≤–∫—É –¥–æ —Ü—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –º–æ–∂–Ω–∞ –≤–∫–∞–∑–∞—Ç–∏, —â–æ –Ω–∞–π–∫—Ä–∞—â–µ 
–ø–æ–∫–∞–∑–∞–ª–∞ —Å–µ–±–µ YJ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è


# –ó–∞–≤–¥–∞–Ω–Ω—è 4: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–∞–Ω—ñ –Ω–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å.

(A) –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ –≥—Ä–∞—Ñ—ñ—á–Ω–æ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–∞ plot(*$residuals, type = "o");
```{r}
plot(mod$residuals, type = "o")
```

(B) –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–∞ lag.plot(*$residuals, lags = 1, do.lines = FALSE)
```{r}
lag.plot(mod$residuals, lags = 1, do.lines = FALSE)
```

(C) –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–∞ cor(*$residuals[-1], mod$residuals[-length(mod$residuals)])
```{r}
cor(mod$residuals[-1], mod$residuals[-length(mod$residuals)])
```
–ó–Ω–∞—á–µ–Ω–Ω—è –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –Ω–µ–≤—ñ–¥'—î–º–Ω–µ, –∞–ª–µ –º–∞–ª–µ

(D) –î–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç –î–∞—Ä–±i–Ω–∞ ‚Äì –í–∞—Ç—Å–æ–Ω–∞;
```{r}
car::durbinWatsonTest(mod)
```


# –ó–∞–≤–¥–∞–Ω–Ω—è 5: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–∞–Ω—ñ –Ω–∞ –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å.

(A) –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö —Ç–∞–±–ª–∏—á–Ω–æ round(cor(data), 2)
```{r}
round(cor(df[, c(1, 4:9)]), 2)
```
Position –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ Peak_Position, Days –≤—ñ–¥ Total_Streams, Peak_Position_times –≤—ñ–¥ Top_Ten_Times.

(B) –ì—Ä–∞—Ñ—ñ—á–Ω–æ corrplot::corrplot(cor(data), addCoef.col = "grey");
```{r}
corrplot::corrplot(cor(df[, c(1, 4:9)]), addCoef.col = "grey")
```
"–ß–æ–º—É –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤—Å—ñ –∑–º—ñ–Ω–Ω—ñ?", –Ω–∞ —Ü–µ —î –≤—ñ–¥–ø–æ–≤—ñ–¥—å. Artist_Name —Ç–∞ Song_Name —î —Å–∏–º–≤–æ–ª—å–Ω–∏–º —Ç–∏–ø–æ–º –π –±—ñ–ª—å—à—ñ—Å—Ç—å –∑ –Ω–∏—Ö —É–Ω—ñ–∫–∞–ª—å–Ω—ñ (99%), —Ç–æ–º—É —ó—Ö –º–æ–∂–Ω–∞ –≤—ñ–¥–∫–∏–Ω—É—Ç–∏ (–¥–æ —Ç–æ–≥–æ –∂ —ó—Ö –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —É cor –π —Ç–ø)
–ó–∞–ª–µ–∂–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –±—É–ª–∏ –≤–∫–∞–∑–∞–Ω—ñ —É –º–∏–Ω—É–ª–æ–º—É –∑–∞–¥–≤–∞–Ω–Ω—ñ

(C) –û–±—á–∏—Å–ª–∏—Ç–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç Variance Inflation Factor (VIF) –¥–ª—è –º–æ–¥–µ–ª—ñ mod;
```{r}
vif(mod)
```

(D) –û–±—á–∏—Å–ª–∏—Ç–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç VIF –≤ –º–æ–¥–µ–ª—ñ mod_1;
```{r}
vif(mod_1)
```

(E) –ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –º–æ–¥–µ–ª—ñ –∑–∞ car::compareCoefs(mod, mod_1)
```{r}
car::compareCoefs(mod, mod_1)
```
–ö–æ–µ—Ñ—ñ—Ü—ñ–µ–Ω—Ç–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è.


# –ó–∞–≤–¥–∞–Ω–Ω—è 6: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–∞–Ω—ñ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–Ω–æ–º–∞–ª—å–Ω–∏—Ö —á–∏ –≤–∏—Å–æ–∫–æ–µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—Ö —Ç–æ—á–æ–∫.

(A) –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ –≥—Ä–∞—Ñ—ñ—á–Ω–æ plot(*, 5);
```{r}
plot(mod, 5)
```

(B) –í–∏–¥–∞–ª–∏—Ç–∏ –∞–Ω–æ–º–∞–ª—å–Ω—É —Ç–æ—á–∫—É —Ç–∞ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ plot(*, 5);
```{r}

# –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –º–µ–¥—ñ–∞–Ω–∏ —Ç–∞ –º—ñ–∂–∫–≤–∞—Ä—Ç–∏–ª—å–Ω–æ–≥–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É –¥–ª—è –≤—Å—ñ—Ö –∑–º—ñ–Ω–Ω–∏—Ö
median_x1 <- median(df$Peak_position_times)
iqr_x1 <- IQR(df$Peak_position_times)
lower_x1 <- median_x1 - 1.5 * iqr_x1
upper_x1 <- median_x1 + 1.5 * iqr_x1

median_x2 <- median(df$Peak_streams)
iqr_x2 <- IQR(df$Peak_streams)
lower_x2 <- median_x2 - 1.5 * iqr_x2
upper_x2 <- median_x2 + 1.5 * iqr_x2

median_x3 <- median(df$Days)
iqr_x3 <- IQR(df$Days)
lower_x3 <- median_x3 - 1.5 * iqr_x3
upper_x3 <- median_x3 + 1.5 * iqr_x3

median_x4 <- median(df$Total_streams)
iqr_x4 <- IQR(df$Total_streams)
lower_x4 <- median_x4 - 1.5 * iqr_x4
upper_x4 <- median_x4 + 1.5 * iqr_x4


# –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—å–Ω–∏—Ö —Ç–æ—á–æ–∫ –¥–ª—è –∫–æ–∂–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó
anomaly_x1 <- which(df$Peak_position_times < lower_x1 | df$Peak_position_times > upper_x1)
anomaly_x2 <- which(df$Peak_streams < lower_x2 | df$Peak_streams > upper_x2)
anomaly_x3 <- which(df$Days < lower_x3 |  df$Days > upper_x3)
anomaly_x4 <- which(df$Total_streams < lower_x4 | df$Total_streams > upper_x4)

# –æ–±'—î–¥–Ω–∞–Ω–Ω—è –≤—Å—ñ—Ö –∞–Ω–æ–º–∞–ª—å–Ω–∏—Ö —Ç–æ—á–æ–∫
anomaly <- unique(c(anomaly_x1, anomaly_x2, anomaly_x3, anomaly_x4))

# –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—å–Ω–∏—Ö —Ç–æ—á–æ–∫
dfn2 <- df[-anomaly, ]

n2y <- dfn2$Top_ten_times
n2x1 <- dfn2$Peak_position_times
n2x2 <- dfn2$Peak_streams
n2x3 <- dfn2$Days
n2x4 <- dfn2$Total_streams

mod_normalized <- lm(n2y~n2x1+n2x2+n2x3+n2x4)
plot(mod_normalized, 5)
```
–Ø–∫–∞ –∫—Ä–∞—Å–∞, –ø—ñ—Å–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—å–Ω–∏—Ö —Ç–æ—á–æ–∫ –≥—Ä–∞—Ñ—ñ–∫ –º–∞–π–∂–µ —ñ–¥–µ–∞–ª—å–Ω–∏–π

(C) –í–∏–¥–∞–ª–∏—Ç–∏ –≤–∏—Å–æ–∫–æ–µ—Ñ–µ–∫—Ç–∏–≤–Ω—É —Ç–æ—á–∫—É —Ç–∞ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ plot(*, 5);
```{r}
# –æ–±—á–∏—Å–ª–µ–Ω–Ω—è Cook's distance –¥–ª—è –∫–æ–∂–Ω–æ—ó —Ç–æ—á–∫–∏
cooksd <- cooks.distance(mod)
# –∑–Ω–∞–π—Ç–∏ —Ç–æ—á–∫–∏ –∑ –≤–∏—Å–æ–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ Cook's distance
high_cooksd <- which(cooksd > 1)
# –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç–æ—á–æ–∫ –∑ –≤–∏—Å–æ–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ Cook's distance
dfn3 <- df[-high_cooksd, ]

ny <- dfn3$Top_ten_times
nx1 <- dfn3$Peak_position_times
nx2 <- dfn3$Peak_streams
nx3 <- dfn3$Days
nx4 <- dfn3$Total_streams

mod_normalized <- lm(ny~nx1+nx2+nx3+nx4)
plot(mod_normalized, 5)
```
–ü—ñ—Å–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤–∏—Å–æ–∫–æ–µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—Ö —Ç–æ—á–æ–∫ –≥—Ä–∞—Ñ—ñ–∫ —Å—Ç–∞–≤ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –∫—Ä–∞—â–µ.