---
title: "Lab_3_2"
output: word_document
date: "2023-03-21"
---

# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ6

# –ü–æ–±—É–¥–æ–≤–∞ —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –Ω–µ–ª—ñ–Ω—ñ–π–Ω–æ—ó –º–Ω–æ–∂–∏–Ω–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó. 

–û–ø–∏—Å dataset

–ù–∞–∑–≤–∞ dataset:
Spotify Top 10000 Streamed Songs

Link –Ω–∞ dataset: 
https://www.kaggle.com/datasets/rakkesharv/spotify-top-10000-streamed-songs

–û–ø–∏—Å dataset —Ç–∞ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–¥–∞—á—ñ:
–¶–µ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, –∑—ñ–±—Ä–∞–Ω–∏–π –∑ –≤–µ–±-—Å–∞–π—Ç—É Spotify, –∫–æ—Ç—Ä–∏–π –º—ñ—Å—Ç–∏—Ç—å –ø–æ—Ç–æ–∫–∏ –≤–∏–∫–æ–Ω–∞–≤—Ü—è
—Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ—Å–ª—ñ—Ö–æ–≤—É–≤–∞–Ω—å (–±—É–ª–æ –≤–∑—è—Ç–æ —Å–∞–º–µ —Ç–æ–ø-10000)
–û—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞: –≤–ø–ª–∏–≤ —Ñ–∞–∫—Ç–æ—Ä—ñ–≤ –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å –ø—ñ—Å–Ω—ñ –π –¥—ñ–∑–Ω–∞—Ç–∏—Å—å –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏—Ö
–≤–∏–∫–æ–Ω–∞–≤—Ü—ñ–≤ —Ç–∞ —Ç—Ä–µ–∫–∏.

–ó–º—ñ–Ω–Ω—ñ —Ç–∞ —ó—Ö –æ–ø–∏—Å:
Position - Spotify Ranking
Artist Name - Artist Name
Song Name - Song Name
Days - No of days since the release of the song (Updated)
Top 10 (xTimes) - No of times inside top 10
Peak Position - Peak position attained
Peak Position (xTimes) - No of times Peak position attained
Peak Streams - Total no of streams during Peak position
Total Streams - Total song streams 


```{r}
library(readr)
library(plotly)
library(GGally)
library(ggplot2)
df <- read_csv("../Spotify_final_dataset.csv")

y <- df$Top_ten_times
x1 <- df$Peak_position_times
x2 <- df$Peak_streams
x3 <- df$Days
x4 <- df$Total_streams
x5 <- df$Peak_position

```

–ó–∞–≤–¥–∞–Ω–Ω—è 1: –ù–µ–ª—ñ–Ω—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ
(A) –ü–æ–±—É–¥—É–≤–∞—Ç–∏ –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ;
–ú–æ–¥–µ–ª—å R + (B) –ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ –≥—Ä–∞—Ñ—ñ—á–Ω–æ;

–£ –¥–∞–Ω–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ –≤ —Ä–æ–ª—ñ 
—Ö –±—É–¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Peak_positon_times
y –±—É–¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Top_ten_times

# 1.ùë¶ = ùëè0 + ùëè1ùë•
a) –†–æ–∑—ñ—é–≤–∞–Ω–Ω—è ùë• —Ç–∞ ùë¶;
b) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –ª—ñ–Ω—ñ–π–Ω—É –º–æ–¥–µ–ª—å 1;
c) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –º–æ–¥–µ–ª—å 2;
```{r}
mod_1 <- lm(y~x1)
ggplot(data = df, aes(x = x1, y = y)) +
  geom_point()+
  stat_smooth(aes(color = "Linear"), method = "lm", se = FALSE)+
  geom_smooth(method = "lm", se = FALSE, formula = y~I(x^2))
```


summary(mod)
```{r}
summary(mod_1)
```


# 2.ùë¶ = ùëè0 + ùëè1ùë•^2
a) –†–æ–∑—ñ—é–≤–∞–Ω–Ω—è ùë• —Ç–∞ ùë¶;
b) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –ª—ñ–Ω—ñ–π–Ω—É –º–æ–¥–µ–ª—å 1;
c) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –º–æ–¥–µ–ª—å 2;
```{r}
mod_2 <- lm(y~I(x1^2))
ggplot(data = df, aes(x = x1, y = y)) +
  geom_point()+
  stat_smooth(method=lm)+
  geom_smooth(aes(color = "Quadratic"), method = "lm", se = FALSE, formula = y~I(x^2))
```


summary(mod)
```{r}
summary(mod_2)
```


# 3.ùë¶ = ùëè0 + ùëè1ùë•^3
a) –†–æ–∑—ñ—é–≤–∞–Ω–Ω—è ùë• —Ç–∞ ùë¶;
b) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –ª—ñ–Ω—ñ–π–Ω—É –º–æ–¥–µ–ª—å 1;
c) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –º–æ–¥–µ–ª—å 2;
```{r}
mod_3 <- lm(y~I(x1^3))
ggplot(data = df, aes(x = x1, y = y)) +
  geom_point()+
  stat_smooth(method=lm)+
  geom_smooth(aes(color = "Cubic"), method = "lm", se = FALSE, formula = y~I(x^3))
```


summary(mod)
```{r}
summary(mod_3)
```


# 4.ùë¶ = ùëè0 + ùëè1*sqrt(ùë•)
a) –†–æ–∑—ñ—é–≤–∞–Ω–Ω—è ùë• —Ç–∞ ùë¶;
b) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –ª—ñ–Ω—ñ–π–Ω—É –º–æ–¥–µ–ª—å 1;
c) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –º–æ–¥–µ–ª—å 2;
```{r}
mod_4 <- lm(y~I(x1^(0.5)))
ggplot(data = df, aes(x = x1, y = y)) +
  geom_point()+
  stat_smooth(method=lm)+
  geom_smooth(aes(color = "Sqrt(x)"), method = "lm", se = FALSE, formula = y~I(x^0.5))
```

summary(mod)
```{r}
summary(mod_4)
```


# 5.ùë¶ = ùëè0 + ùëè1 exp(ùë•)
a) –†–æ–∑—ñ—é–≤–∞–Ω–Ω—è ùë• —Ç–∞ ùë¶;
b) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –ª—ñ–Ω—ñ–π–Ω—É –º–æ–¥–µ–ª—å 1;
c) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –º–æ–¥–µ–ª—å 2;
```{r}
mod_5 <- lm(y~exp(x1))
ggplot(data = df, aes(x = x1, y = y)) +
  geom_point()+
  stat_smooth(method=lm)+
  geom_smooth(aes(color = "Exponential(x)"), method = "lm", se = FALSE, formula = y~exp(x))
```

summary(mod)
```{r}
summary(mod_5)
```


# 6.ùë¶ = ùëè0 + ùëè1 exp(‚àíùë•)
a) –†–æ–∑—ñ—é–≤–∞–Ω–Ω—è ùë• —Ç–∞ ùë¶;
b) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –ª—ñ–Ω—ñ–π–Ω—É –º–æ–¥–µ–ª—å 1;
c) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –º–æ–¥–µ–ª—å 2;
```{r}
mod_6 <- lm(y~exp(-x1))
ggplot(data = df, aes(x = x1, y = y)) +
  geom_point()+
  stat_smooth(method=lm)+
  geom_smooth(aes(color = "Exponential(-x)"), method = "lm", se = FALSE, formula = y~exp(-x))
```

summary(mod)
```{r}
summary(mod_6)
```


# 7,ùë¶ = ùëè0 + ùëè1((ùëã + 1)3 ‚àí log(ùëã + 5))
a) –†–æ–∑—ñ—é–≤–∞–Ω–Ω—è ùë• —Ç–∞ ùë¶;
b) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –ª—ñ–Ω—ñ–π–Ω—É –º–æ–¥–µ–ª—å 1;
c) –ù–∞–∫–ª–∞—Å—Ç–∏ –Ω–∞ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è a) –º–æ–¥–µ–ª—å 2;
```{r}
mod_7 <- lm(y~I((x1+1)^3-log(x1+5)))
ggplot(data = df, aes(x = x1, y = y)) +
  geom_point()+
  stat_smooth(method=lm)+
  geom_smooth(aes(color = "Poly+Exp"), method = "lm", se = FALSE, formula = y~I(poly(x+1,3)-log(x+5)))
```


summary(mod)
```{r}
summary(mod_7)
```


(C) –ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –º–æ–¥–µ–ª—ñ 1 ‚Äì 7 —Ç–∞ –∑—Ä–æ–±–∏—Ç–∏ –≤–∏—Å–Ω–æ–≤–∫–∏ –ø—Ä–æ –Ω–∞–π–∫—Ä–∞—â—É –º–æ–¥–µ–ª—å.

# –¢—É—Ç —Ç–∞–±–ª–∏—Ü—è —Ç–∞ –≤–∏—Å–Ω–æ–≤–æ–∫


# –ó–∞–≤–¥–∞–Ω–Ω—è 2: –ù–µ–ª—ñ–Ω—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–ª–∞—Å–∏—á–Ω–æ–≥–æ –ø–æ–ª—ñ–Ω–æ–º—É
(A) –ü–æ–±—É–¥—É–π—Ç–µ –ø–æ–ª—ñ–Ω–æ–º–∏ ùëå = ùõΩ0 + ùõΩ1ùëã + ‚ãØ + ùõΩùëòùëãùëò + ùúÄ –¥–æ 5-–≥–æ —Å—Ç—É–ø–µ–Ω—è —Ç–∞ 10-–π;
```{r}
mod_5p <- lm(y ~ poly(x1, 5, raw = TRUE))
mod_10p <- lm(y ~ poly(x1, 10, raw = TRUE))
```

(B) –í–∏–∑–Ω–∞—á—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∏–π –ø–æ–ª—ñ–Ω–æ–º –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é BIC(*);
```{r}
BIC(mod_1,mod_2,mod_3,mod_5p,mod_10p)
```
mod_10 –∫—Ä–∞—â–∞ (–º–µ–Ω—à–µ - –∫—Ä–∞—â–µ)

(C) –ü–æ–±—É–¥—É–π—Ç–µ:
a) —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è ùë• —Ç–∞ ùë¶;
b) –Ω–∞–∫–ª–∞–¥—ñ—Ç—å –ø—Ä—è–º—É –ª—ñ–Ω—ñ—é;
c) –ø–æ–ª—ñ–Ω–æ–º—ñ–∞–ª—å–Ω—ñ –º–æ–¥–µ–ª—ñ. 
```{r}
ggplot(data = df, aes(x = x1, y = y)) +
  geom_point()+
  stat_smooth(aes(color = "Linear"), method = "lm", se = FALSE)+
  geom_smooth(aes(color = "Poly(5)"), method = "lm", se = FALSE, formula = y ~ poly(x, 5,raw = TRUE))+
  geom_smooth(aes(color = "Poly(10)"), method = "lm", se = FALSE, formula = y ~ poly(x, 10, raw = TRUE))
```
–¶—ñ–∫–∞–≤–∏–π –≥—Ä–∞—Ñ—ñ–∫ —É Poly(10)


# –ó–∞–≤–¥–∞–Ω–Ω—è 3: –ù–µ–ª—ñ–Ω—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–æ–ª—ñ–Ω–æ–º—É –õ–µ–∂–∞–Ω—Ä–∞.

(A) –ü–æ–±—É–¥—É–π—Ç–µ –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω—ñ –ø–æ–ª—ñ–Ω–æ–º–∏ –õ–µ–∂–∞–Ω—Ä–∞ –¥–æ 5-–≥–æ —Å—Ç—É–ø–µ–Ω—è —Ç–∞ 10-–π;
```{r}
mod_5pl <- lm(y ~ poly(x1, 5, raw = FALSE))
mod_10pl <- lm(y ~ poly(x1, 10, raw = FALSE))
```

(B) –í–∏–∑–Ω–∞—á—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∏–π –ø–æ–ª—ñ–Ω–æ–º –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é BIC(*);
```{r}
BIC(mod_1,mod_2,mod_3,mod_5pl,mod_10pl)
```
–ù–∞–π–∫—Ä–∞—â–∞ –º–æ–¥–µ–ª—å –∑ 10 —Å—Ç—É–ø–µ–Ω—è–º–∏

(C) –ü–æ–±—É–¥—É–π—Ç–µ:
a) —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è ùë• —Ç–∞ ùë¶;
b) –Ω–∞–∫–ª–∞–¥—ñ—Ç—å –ø—Ä—è–º—É –ª—ñ–Ω—ñ—é;
c) –ø–æ–ª—ñ–Ω–æ–º—ñ–∞–ª—å–Ω—ñ –º–æ–¥–µ–ª—ñ –õ–µ–∂–∞–Ω—Ä–∞:
```{r}
ggplot(data = df, aes(x = x1, y = y)) +
  geom_point()+
  stat_smooth(aes(color = "Linear"), method = "lm", se = FALSE)+
  geom_smooth(aes(color = "PolyL(5)"), method = "lm", se = FALSE, formula = y ~ poly(x, 5, raw = FALSE))+
  geom_smooth(aes(color = "PolyL(10)"), method = "lm", se = FALSE, formula = y ~ poly(x, 10, raw = FALSE))
```


# –ó–∞–≤–¥–∞–Ω–Ω—è 4: –ù–µ–ª—ñ–Ω—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º.

(A) –ü–æ–±—É–¥—É–π—Ç–µ –≤–∑–∞—î–º–æ–¥—ñ—é –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏ ùë•ùëñ –¥–ª—è —Ç–∞–∫–∏—Ö –º–æ–¥–µ–ª–µ–π. –í–∏–∑–Ω–∞—á—Ç–µ —è–∫–∞
–∫—Ä–∞—â–∞:
a) ùë¶~ùë•1 ‚àó ùë•2
```{r}
mod_8 <- lm(y~x1*x2)
summary(mod_8)
```

b) ùë¶~ùë•1 ‚àó ùë•2 ‚àó ùë•3
```{r}
mod_9 <- lm(y~x1*x2*x3)
summary(mod_9)
```

c) ùëÄùê¥ùëÜùëÜ: : ùë†ùë°ùëíùëùùê¥ùêºùê∂(ùëúùëèùëóùëíùëêùë° = ùëôùëö(ùë¶ ~ . , ùëëùëéùë°ùëé), ùë†ùëêùëúùëùùëí = ùë¶ ~ . ^2, ùëò =ùëôùëúùëî(ùëõùëúùëèùë†(ùëöùëúùëëùêµùêºùê∂)),ùë°ùëüùëéùëêùëí = 0).
```{r}
modAll <- lm(y ~ x1 + x2 + x3 + x4 + x5);
modBIC <- MASS::stepAIC(modAll, k = log(nrow(df)))

mod_10 <- MASS::stepAIC(object=lm(y ~ x1 + x2 + x3 + x4 + x5), scope = (y~ x1^2 + x2^2 + x3^2 + x4^2 + x5^2),
k=log(nobs(modBIC)),trace=0)
summary(mod_10)
```

(B) –í–∏–∑–Ω–∞—á—Ç–µ –∫—Ä–∞—â—É –º–æ–¥–µ–ª—å –∑ –ø—É–∫—Ç—É (A)
–ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é summary –º–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ mod_10 –∫—Ä–∞—â–∞


# –ó–∞–≤–¥–∞–Ω–Ω—è 5: –ù–µ–ª—ñ–Ω—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ –Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–æ—é —Ç–∞ –±—ñ–Ω–∞—Ä–Ω–æ—é –∑–º—ñ–Ω–Ω–æ—é.

(A) –ü–æ–±—É–¥—É–π—Ç–µ –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ –Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–æ—é —Ç–∞ –±—ñ–Ω–∞—Ä–Ω–æ—é –∑–º—ñ–Ω–Ω–æ—é.

a) ùëåùëñ = ùõΩ0 + ùõΩ1ùëãùëñ + ùõΩ2ùê∑ùëñ + ùë¢ùëñ
```{r}

```

b) ùëåùëñ = ùõΩ0 + ùõΩ1ùëãùëñ + ùõΩ2ùê∑ùëñ + ùõΩ3(ùëãùëñ √ó ùê∑ùëñ) + ùë¢ùëñ
```{r}

```

c) ùëåùëñ = ùõΩ0 + ùõΩ1ùëãùëñ + ùõΩ2(ùëãùëñ √ó ùê∑ùëñ) + ùë¢ùëñ
```{r}

```


(B) –í–∏–∑–Ω–∞—á—Ç–µ –∫—Ä–∞—â—É –º–æ–¥–µ–ª—å –∑ –ø—É–∫—Ç—É (A)