---
title: "Lab_3.1"
output: word_document
date: "2023-03-14"
---

# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ3 (—á–∞—Å—Ç–∏–Ω–∞ 1)

# –ü–æ–±—É–¥–æ–≤–∞ —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –ª—ñ–Ω—ñ–π–Ω–æ—ó –º–Ω–æ–∂–∏–Ω–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó.

–û–ø–∏—Å dataset

–ù–∞–∑–≤–∞ dataset:
Spotify Top 10000 Streamed Songs

Link –Ω–∞ dataset: 
https://www.kaggle.com/datasets/rakkesharv/spotify-top-10000-streamed-songs

–û–ø–∏—Å dataset —Ç–∞ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–¥–∞—á—ñ:
–¶–µ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, –∑—ñ–±—Ä–∞–Ω–∏–π –∑ –≤–µ–±-—Å–∞–π—Ç—É Spotify, –∫–æ—Ç—Ä–∏–π –º—ñ—Å—Ç–∏—Ç—å –ø–æ—Ç–æ–∫–∏ –≤–∏–∫–æ–Ω–∞–≤—Ü—è
—Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ—Å–ª—ñ—Ö–æ–≤—É–≤–∞–Ω—å (–±—É–ª–æ –≤–∑—è—Ç–æ —Å–∞–º–µ —Ç–æ–ø-10000)
–û—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞: –≤–ø–ª–∏–≤ —Ñ–∞–∫—Ç–æ—Ä—ñ–≤ –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å –ø—ñ—Å–Ω—ñ –π –¥—ñ–∑–Ω–∞—Ç–∏—Å—å –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏—Ö
–≤–∏–∫–æ–Ω–∞–≤—Ü—ñ–≤ —Ç–∞ —Ç—Ä–µ–∫–∏.

–ó–º—ñ–Ω–Ω—ñ —Ç–∞ —ó—Ö –æ–ø–∏—Å:
Position - Spotify Ranking
Artist Name - Artist Name
Song Name - Song Name
Days - No of days since the release of the song (Updated)
Top 10 (xTimes) - No of times inside top 10
Peak Position - Peak position attained
Peak Position (xTimes) - No of times Peak position attained
Peak Streams - Total no of streams during Peak position
Total Streams - Total song streams 



```{r}
library(readr)
library(plotly)
library(GGally)
library(ggplot2)
df <- read_csv("../Spotify_final_dataset.csv")

Y <- df$Top_ten_times
x1 <- df$Peak_position_times
x2 <- df$Peak_streams
x3 <- df$Days
x4 <- df$Total_streams
x5 <- df$Peak_position

x1_scaled <- scale(x1)
x2_scaled <- scale(x2)
x3_scaled <- scale(x3)
x4_scaled <- scale(x4)
x5_scaled <- scale(x5)
dataCen <- data.frame(scale(df[c(1,4:9)] , center = TRUE,scale = FALSE))

mod2 <- lm(Y ~ x1_scaled + x2_scaled);
mod3 <- lm(Y ~ x1_scaled + x2_scaled + x3_scaled);
modAll <- lm(Y ~ x1_scaled + x2_scaled + x3_scaled + x4_scaled + x5_scaled);
modInter <- lm(Y ~ x1_scaled + x2_scaled + x3_scaled, )
modZero <- lm(Y ~ 1)
```
# –ó–∞–≤–¥–∞–Ω–Ω—è 1: –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –º—ñ—Ä–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ (BIC / AIC)


(A) –û–±–µ—Ä—ñ—Ç—å 5-—Ç—å –∑–º—ñ–Ω–Ω–∏—Ö, —è–∫—ñ –Ω–∞ –≤–∞—à—É –¥—É–º–∫—É –º–∞—é—Ç—å –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ—Å—Ç—å, —Ç–∞ –ø–æ–±—É–¥—É–π—Ç–µ
—Å–∫–∞—Ç–µ—Ä–ø–ª–æ—Ç; 
car::scatterplotMatrix(~ x1 + x2 + x3 + x4 + x5, regLine = list(col = 2),
 col = 1, smooth = list(col.smooth = 4, col.spread = 4),
 data = data)

```{r}
car::scatterplotMatrix( ~ x1_scaled + x2_scaled + x3_scaled 
                        + x4_scaled + x5_scaled, regLine = list(col = 2),
 col = 1, smooth = list(col.smooth = 4, col.spread = 4),
 data = df)
```
 
(B) –ü–æ–±—É–¥—É–π—Ç–µ BIC —Ç–∞ AIC –¥–ª—è –º–æ–¥–µ–ª–µ–π mod2 —Ç–∞ mod3;
```{r}
#BIC
BIC(mod2)
BIC(mod3)

#AIC
AIC(mod2)
AIC(mod3)
```

(C) –Ø–∫–∞ –º–æ–¥–µ–ª—å mod2 —á–∏ mod3 –∫—Ä–∞—â–∞ –∑–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—î–º AIC;
–ó–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—î–º –ê–Ü–° –∫—Ä–∞—â–∞ –º–æ–¥–µ–ª—å - mod3

(D) –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ (C) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é summary(_);
```{r}
summary(mod2)
summary(mod3)
```
–ó –∞–Ω–∞–ª—ñ–∑—É –º–æ–∂–Ω–∞ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ —â–æ mod3 –±—É–¥–µ –∫—Ä–∞—â–æ—é


# –ó–∞–≤–¥–∞–Ω–Ω—è 2: –ü–æ—à—É–∫ –Ω–∞–∫—Ä–∞—â–æ—ó –ø—ñ–¥–º–Ω–æ–∂–∏–Ω–∏ —Ñ–∞–∫—Ç–æ—Ä—ñ–≤


(A) –ó—Ä–æ–±–∏—Ç–∏ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é MASS::stepAIC –º–æ–¥–µ–ª—ñ –∑–∞ –≤—Å—ñ–º–∞
–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ modAll, —è–∫—ñ —î –≤ dataset.
```{r}
modAIC <- MASS::stepAIC(modAll, k = 2)
``` 

(B) –ü–æ–±—É–¥—É–≤–∞—Ç–∏ –∫—Ä–∏—Ç–µ—Ä—ñ–π AIC

 o modAIC <- MASS::stepAIC(mod, k = 2).
```{r}
modAIC <- MASS::stepAIC(modAll, k = 2)
``` 
 o –û–ø–∏—Å–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è AIC –Ω–∞ –∫–æ–∂–Ω–æ–º—É –µ—Ç–∞–ø—ñ —ñ –≤–∫–∞–∑–∞—Ç–∏ —è–∫–∞ –∑–º—ñ–Ω–Ω–∞
   –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è;
 –ï—Ç–∞–ø—ñ–≤ –Ω–µ–º–∞—î, –∑–Ω–∞—á–µ–Ω–Ω—è –ê–Ü–° —Ä—ñ–≤–Ω–µ = 46692.29
 
 o –ó–∞–ø–∏—Å–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª—å–Ω–µ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –º–æ–¥–µ–ª—å;
```{r}
summary(modAIC)
``` 

(C) –ü–æ–±—É–¥—É–≤–∞—Ç–∏ –∫—Ä–∏—Ç–µ—Ä—ñ–π BIC

 o MASS::stepAIC(*, trace = 0, k = log(n))).
```{r}
modBIC <- MASS::stepAIC(modAll, k = log(nrow(df)))

```
 –ï—Ç–∞–ø—ñ–≤ –Ω–µ–º–∞—î, –∑–Ω–∞—á–µ–Ω–Ω—è –í–Ü–° = 46736.17
 
 o –ó–∞–ø–∏—Å–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª—å–Ω–µ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –º–æ–¥–µ–ª—å;
```{r}
summary(modBIC)
```

# –ó–∞–≤–¥–∞–Ω–Ω—è 3: –ü–æ—à—É–∫ –Ω–∞–∫—Ä–∞—â–æ—ó –ø—ñ–¥–º–Ω–æ–∂–∏–Ω–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ direction = ‚Äúforward‚Äù,
# ‚Äúbackward‚Äù –∞–±–æ ‚Äúboth‚Äù.


(A) –ü–æ–±—É–¥—É–≤–∞—Ç–∏ MASS::stepAIC –∑–∞ direction = backward:

 o MASS::stepAIC (modAll, direction = "backward", k = log(n));
```{r}
modBack <- MASS::stepAIC (modAll, direction = "backward", k = log(nrow(df)))
``` 
 –ï—Ç–∞–ø—ñ–≤ –Ω–µ–º–∞—î, –∑–Ω–∞—á–µ–Ω–Ω—è —Ä—ñ–≤–Ω–µ 46736.17
 
 o –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–æ –∑–∞–ø–∏—Å–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª—å–Ω—É –º–æ–¥–µ–ª—å;
```{r}
summary(modBack)
``` 
 
 
(B) –ü–æ–±—É–¥—É–≤–∞—Ç–∏ MASS::stepAIC –∑–∞ direction = forward:

 o MASS::stepAIC(modZero, direction = "forward", scope = list(lower =
   modZero, upper = modAll), k = log(n));
```{r}
modFwd1 <- MASS::stepAIC(modZero, direction = "forward", scope = list(lower =
   modZero, upper = modAll), k = log(nrow(df)))
```   
 6 –µ—Ç–∞–ø—ñ–≤, –∑–Ω–∞—á–µ–Ω–Ω—è
 1. 60915.68 (–∞–Ω–∞–ª—ñ–∑ Y ~ 1)
 2. 52221.39 (–∞–Ω–∞–ª—ñ–∑ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Y ~ Total_streams)
 3. 47928.5 (–∞–Ω–∞–ª—ñ–∑ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Y ~ Total_streams + Peak_position_times)
 4. 46791.18 (–∞–Ω–∞–ª—ñ–∑ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Y ~ Total_streams + Peak_position_times 
 + Days)
 5. 46736.32 (–∞–Ω–∞–ª—ñ–∑ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Y ~ Total_streams + Peak_position_times 
 + Days + Peak_streams)
 –§—ñ–Ω–∞–ª—å–Ω–µ = 46736.17 (–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –≤—Å—ñ –∑–º—ñ–Ω–Ω—ñ)
 
 o –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–æ –∑–∞–ø–∏—Å–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª—å–Ω—É –º–æ–¥–µ–ª—å;
```{r}
summary(modFwd1)
``` 
 
(C) –ü–æ–±—É–¥—É–≤–∞—Ç–∏ MASS::stepAIC –∑–∞ direction = forward:

 o MASS::stepAIC(modInter, direction = "forward", scope = list(lower =
  modZero, upper = modAll), k = log(n));
```{r}
modFwd2 <- MASS::stepAIC(modInter, direction = "forward", scope = list(lower =
  modZero, upper = modAll), k = log(nrow(df)))
```  
 3 –µ—Ç–∞–ø–∏, –∑–Ω–∞—á–µ–Ω–Ω—è
 1. 50091.37 (–∞–Ω–∞–ª—ñ–∑ Y ~ Peak_Position_times + Peak_Streams + Days)
 2. 46736.32 (–∞–Ω–∞–ª—ñ–∑ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Y ~ Peak_Position_times + Peak_Streams 
 + Days + Total_streams)
 –§—ñ–Ω–∞–ª—å–Ω–µ = 46736.17 (–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –≤—Å—ñ –∑–º—ñ–Ω–Ω—ñ)
 
 o –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–æ –∑–∞–ø–∏—Å–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª—å–Ω—É –º–æ–¥–µ–ª—å;
```{r}
summary(modFwd2)
``` 
 
 
 
(D) –ü–æ–±—É–¥—É–≤–∞—Ç–∏ MASS::stepAIC –∑–∞ direction = both:

 o MASS::stepAIC(modInter, direction = "both", scope = list(lower =
   modZero, upper = modAll), k = log(n));
```{r}
modBoth <- MASS::stepAIC(modInter, direction = "both", scope = list(lower =
   modZero, upper = modAll), k = log(nrow(df)))
```
3 –µ—Ç–∞–ø–∏, –∑–Ω–∞—á–µ–Ω–Ω—è
 1. 50091.37 (–∞–Ω–∞–ª—ñ–∑ Y ~ Peak_Position_times + Peak_Streams + Days)
 2. 46736.32 (–∞–Ω–∞–ª—ñ–∑ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Y ~ Peak_Position_times + Peak_Streams 
 + Days + Total_streams)
 –§—ñ–Ω–∞–ª—å–Ω–µ = 46736.17 (–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –≤—Å—ñ –∑–º—ñ–Ω–Ω—ñ)
 –ù–µ –≤—ñ–¥—Ä—ñ–∑–Ω–∞—î—Ç—å—Å—è –≤—ñ–¥ modFwd2
 
 o –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–æ –∑–∞–ø–∏—Å–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª—å–Ω—É –º–æ–¥–µ–ª—å;
```{r}
summary(modBoth)
```
 
 –ó–∞–≥–∞–ª—å–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫: —Å–µ—Ä–µ–¥ —É—Å–∏—Ö –≤–∞—Ä—ñ–∞—Ü—ñ–π –º–Ω–æ–∂–∏–Ω, –Ω–∞–∫–π–∫—Ä–∞—â–æ—é –≤–∏—è–≤–∏–ª–∞—Å—å –∑ —É—Å—ñ–º–∞ 
 –∑–º—ñ–Ω–Ω–∏–º–∏ –ø—Ä–∏ —Å–æ–±—ñ, –Ω–æ –º–æ–∂–µ–º–æ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ –º–æ–¥–µ–ª—å
 Y ~ Peak_Position_times + Peak_Streams + Days + Total_streams –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å—Ö–æ–∂–∞
 –∑–∞ –∑–Ω–∞—á–µ–Ω–Ω—è–º –∑–∞ –ø–æ–≤–Ω–æ—ó –º–æ–¥–µ–ª—ñ, —Ç–æ–º—É –º–æ–∂–Ω–∞ —Å–∫–∞–∑–∞—Ç–∏, —â–æ Peak_position –Ω–µ —Å–∏–ª—å–Ω–æ 
 –≤–ø–ª–∏–≤–∞—î –Ω–∞ –Ω–∞—à –∞–Ω–∞–ª—ñ–∑
 
 
# –ó–∞–≤–¥–∞–Ω–Ω—è 4: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —è–∫—ñ—Å–Ω–∏—Ö –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä—ñ–≤.


(A) –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö str(data);
```{r}
df$Peak_position_times <- as.factor(df$Peak_position_times)
df = subset(df, select = -c(Artist_name, Song_name))
str(df)
# –ö–æ—Ä–æ—Ç–∫–∏–π –∑–º—ñ—Å—Ç –ª—ñ–Ω—ñ–π–Ω–æ—ó –º–æ–¥–µ–ª—ñ
mod1 <- lm(Top_ten_times ~ ., data = df)
summary(mod1)
```
–Ø–∫ –º–∏ –±–∞—á–∏–º–æ –æ—á–µ–≤–∏–¥–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö –≤ –Ω–∞—à–æ–º—É –¥–∞—Ç–∞—Å–µ—Ç—ñ –Ω–µ–º–∞—î,
–∞–ª–µ –º–∏ –º–æ–∂–µ–º–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–∞–∑ –≤ —Ç–æ–ø—ñ —è–∫ –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω—É –∑–º—ñ–Ω–Ω—É
–ù–∞–π–¥–æ—Ä–æ–∂—á–∞ –∑–º—ñ–Ω–Ω–∞ - Peak_position_times19

(B) –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫–æ–¥—É–≤–∞–Ω–Ω—è —Ñ—ñ–∫—Ç–∏–≤–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó contrasts(data$x);
```{r}
contrasts(df$Peak_position_times)
```
–Ø–∫ –º–∏ –±–∞—á–∏–º–æ,–∑–∞—Ä–∞–∑ –µ—Ç–∞–ª–æ–Ω–Ω–∞ –∑–º—ñ–Ω–Ω–∞ Peak_position_times0

(C) –ó–º—ñ–Ω–∞ –µ—Ç–∞–ª–æ–Ω–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é relevel(*)
```{r}
df$Peak_position_times <- relevel(df$Peak_position_times, ref='19')
```

(D) –ü–æ–±—É–¥–æ–≤–∞ –º–æ–¥–µ–ª—ñ –∑ —Ñ—ñ–∫—Ç–∏–≤–Ω–æ—é –∑–º—ñ–Ω–Ω–æ—é ùëå = ùõΩ0 + ùõΩ1ùë•1 + ùõΩ2ùë•2 + ùõΩ3ùê∑;
```{r}
mod2 <- lm(Top_ten_times ~ Total_streams + Peak_streams+Peak_position_times, data = df )
summary(mod2)
```
–Ø–∫ –º–∏ –±–∞—á–∏–º–æ, –∫–æ–ª–∏ Peak_position_times19 —Å—Ç–∞–ª–∞ –≥–æ–ª–æ–≤–Ω–æ—é, —Ç–æ —É—Å—ñ —ñ–Ω—à—ñ –∑–º—ñ–Ω–Ω—ñ –¥—É–∂–µ —Å–∏–ª—å–Ω–æ –≤—Ç—Ä–∞—Ç–∏–ª–∏ –≤ —Ü—ñ–Ω–Ω–æ—Å—Ç—ñ

(E) –í–∏—Å–Ω–æ–≤–∫–∏: –Ω–∞ —Å–∫—ñ–ª—å–∫–∏ –∑–º—ñ–Ω–∏—Ç—å—Å—è –ø—Ä–∏—Ä—ñ—Å—Ç —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è Y, —è–∫–∏–π
–ø–æ–≤'—è–∑–∞–Ω–∏–π –∑—ñ –∑–º—ñ–Ω–æ—é ùê∑ = 0 –Ω–∞ ùê∑ = 1.

–î–ª—è –Ω–∞—à–æ–≥–æ –≤–∏–ø–∞–¥–∫—É –≤–∞–∂–∫–æ –ø—Ä–æ–ø–∏—Å–∞—Ç–∏ –∫–æ–∂–µ–Ω –∫–æ—î—Ñ—ñ—Ü—ñ—î–Ω—Ç, –æ—Å–∫—ñ–ª—å–∫–∏ —É –Ω–∞—Å 31 –∫–∞—Ç–µ–≥–æ—Ä—ñ—è,
–∞–ª–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é summary(mod2) –º–æ–∂–Ω–∞ –ª–µ–≥–∫–æ –ø–æ–±–∞—á–∏—Ç–∏ –Ω–∞ —Å–∫—ñ–ª—å–∫–∏ –∑–º—ñ–Ω–∏–≤—Å—è –∫–æ–∂–Ω–∏–π –∫–æ—î—Ñ—ñ—Ü—ñ—î–Ω—Ç
```{r}
summary(mod2)
```


